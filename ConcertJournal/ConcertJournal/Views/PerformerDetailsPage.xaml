<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ConcertJournal.Views.PerformerDetailsPage"
             xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
             xmlns:controls="clr-namespace:ConcertJournal.Views.Controls"
             BackgroundColor="{DynamicResource Background}"
             Shell.NavBarIsVisible="False">
    
    <Grid RowDefinitions="*,Auto">
        <!--Main content-->
        <Grid
            Grid.Row="0"
            RowDefinitions="Auto,*">
            <Grid Grid.Row="0"
                  ColumnDefinitions=".15*,.7*,.15*"
                  BackgroundColor="{DynamicResource CardBackground}"
                  Padding="4">
                <Button 
                    Grid.Column="0"
                    Text="â† Back"
                    FontSize="18"
                    TextColor="{DynamicResource ButtonTextColor}"
                    BackgroundColor="{DynamicResource ButtonBackground}"
                    CornerRadius="12"
                    VerticalOptions="Center"
                    HorizontalOptions="Start"
                    Clicked="OnBackClicked"/>
        
                <Label 
                    Grid.Column="1"
                    Text="{Binding PerformerName}" 
                    FontAttributes="Bold"
                    FontSize="24" 
                    TextTransform="Uppercase"
                    HorizontalTextAlignment="Center" 
                    LineBreakMode="WordWrap"
                    Padding="0,8"/>
            </Grid>

            <Grid 
                Grid.Row="1"
                RowDefinitions=".3*,.7*"
                Padding="4">

                <!--Stats labels-->
                <VerticalStackLayout 
                    Grid.Row="0"
                    HorizontalOptions="Center">

                    <!--Stats title-->
                    <Label 
                        Grid.Row="0"
                        Text="Statistics"
                        FontAttributes="Bold"
                        TextDecorations="Underline"
                        FontSize="20" 
                        HorizontalOptions="Center"
                        Margin="4"/>

                    <Grid
                        RowDefinitions="*,*"
                        ColumnDefinitions="*,*">

                        <!-- Total Shows Seen -->
                        <Border
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="0,0,0,24">
                            <VerticalStackLayout>
                                <Label 
                                    FontSize="20"
                                    FontAttributes="Bold"
                                    Text="Total Shows Seen:"
                                    HorizontalTextAlignment="Center"/>
                                <Label 
                                    FontSize="32"
                                    FontAttributes="Bold"
                                    x:Name="TimesSeenLabel"
                                    Text="-" 
                                    HorizontalTextAlignment="Center"/>
                            </VerticalStackLayout>
                        </Border>

                        <!-- Countries Seen In -->
                        <Border
                            Grid.Row="0"
                            Grid.Column="1"
                            Margin="0,0,0,24">
                            <VerticalStackLayout>
                                <Label
                                    FontSize="20"
                                    FontAttributes="Bold"
                                    Text="Countries Seen In:"
                                    HorizontalTextAlignment="Center"/>
                                <Label 
                                    FontSize="32"
                                    FontAttributes="Bold"
                                    x:Name="CountriesSeenLabel" 
                                    Text="-" 
                                    HorizontalTextAlignment="Center"/>
                            </VerticalStackLayout>
                        </Border>

                        <!-- First Show Attended -->
                        <Border
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="0,0,0,24">
                            <VerticalStackLayout>
                                <Label 
                                    FontSize="20"
                                    FontAttributes="Bold"
                                    Text="First Show Attended:"
                                    HorizontalTextAlignment="Center"/>
                                <Label
                                    FontSize="20"
                                    FontAttributes="Bold"
                                    x:Name="FirstSeenLabel" 
                                    Text="-" 
                                    HorizontalTextAlignment="Center"/>
                            </VerticalStackLayout>
                        </Border>

                        <!-- Last Show Attended -->
                        <Border
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="0,0,0,24">
                            <VerticalStackLayout>
                                <Label 
                                    FontSize="20"
                                    FontAttributes="Bold"
                                    Text="Last Show Attended:"
                                    HorizontalTextAlignment="Center"/>
                                <Label 
                                    FontSize="20"
                                    FontAttributes="Bold"
                                    x:Name="RecentSeenLabel" 
                                    Text="-" 
                                    HorizontalTextAlignment="Center"/>
                            </VerticalStackLayout>
                        </Border>
                    </Grid>
                </VerticalStackLayout>

                <Grid 
                    Grid.Row="1"
                    RowDefinitions="Auto,*">
                    
                    <!--Concerts list-->
                    <Label 
                        Grid.Row="0"
                        Text="Concerts Attended"
                        FontAttributes="Bold"
                        TextDecorations="Underline"
                        FontSize="20" 
                        HorizontalOptions="Center"
                        Margin="4"/>
                    
                    <CollectionView
                        Grid.Row="1"
                        ItemsSource="{Binding Concerts}"
                        ItemsLayout="VerticalGrid, 2"
                        VerticalScrollBarVisibility="Never">
                        <!--TODO: Add spacing between items but keep them on verticalgrid-->
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border
                                    StrokeShape="RoundRectangle 16"
                                    Stroke="{DynamicResource CardBorder}">
                                    <Grid 
                                        ColumnDefinitions=".8*,.2*"
                                        RowDefinitions="*,*,*"
                                        Padding="8">

                                        <Label 
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            Text="{Binding EventTitle}" 
                                            FontAttributes="Bold" 
                                            FontSize="16"/>

                                        <Label 
                                            Grid.Row="1"
                                            Grid.Column="0"
                                            Text="{Binding Location}" 
                                            FontSize="14"/>

                                        <Label 
                                            Grid.Row="2"
                                            Grid.Column="0"
                                            Text="{Binding Date, StringFormat='{}{0:dd MMM yyyy}'}" 
                                            FontSize="12"/>

                                        <ImageButton 
                                            Grid.RowSpan="3"
                                            Grid.Column="1"
                                            Source="{DynamicResource DetailsIcon}"
                                            Clicked="OnDetailsClicked"
                                            BindingContext="{Binding .}"
                                            HorizontalOptions="End"
                                            VerticalOptions="Center"
                                            HeightRequest="48"
                                            WidthRequest="48"
                                            Padding="8"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </Grid>
            </Grid>
        </Grid>

        <!--Navigation bar-->
        <controls:BottomNavBar Grid.Row="2" />
    </Grid>
</ContentPage>